<!--components/task-card/task-card.wxml-->
<view 
  class="task-card {{task.isExtra ? 'task-card-extra' : ''}}" 
  style="background-color: {{task.cardColor}}; animation: {{animation}}"
  bindtap="onTapCard"
  bindlongpress="onLongPressCard"
>
  <!-- 置顶标记（课后加餐） -->
  <view wx:if="{{task.isExtra}}" class="pin-badge">
    <text class="pin-icon">📌</text>
    <text class="pin-text">置顶</text>
  </view>

  <!-- 卡片主体 -->
  <view class="card-body">
    <!-- 上部分 -->
    <view class="card-top">
      <!-- 左上角：标题 -->
      <view class="card-title">
        <text class="title-text">{{task.title}}</text>
        <text class="course-text">{{task.course}}</text>
      </view>
      
      <!-- 右上角：评价/状态 -->
      <view class="card-status">
        <view class="status-badge status-{{task.topRightType}}">
          {{task.topRightText}}
        </view>
        <!-- 如果有分数，显示分数 -->
        <view wx:if="{{task.submission_score !== null && task.submission_score !== undefined}}" class="score-text">
          {{task.submission_score}}/{{task.total_score}}分
        </view>
      </view>
    </view>

    <!-- 中间：题目描述（截取） -->
    <view class="card-middle">
      <text class="desc-text">{{task.desc}}</text>
    </view>

    <!-- 下部分 -->
    <view class="card-bottom">
      <!-- 左下角：状态标签 -->
      <view class="status-label">
        <view class="label label-{{task.statusType}}">
          {{task.statusLabel}}
        </view>
        <!-- 任务类型标签 -->
        <view wx:if="{{task.task_type === 'live'}}" class="label label-live">
          <text class="label-icon">🎥</text>
          <text>直播课</text>
        </view>
        <view wx:elif="{{task.task_type === 'extra'}}" class="label label-extra">
          <text class="label-icon">📚</text>
          <text>课后加餐</text>
        </view>
      </view>
      
      <!-- 右下角：日期 -->
      <view class="card-date">
        <text class="date-icon">📅</text>
        <text class="date-text">{{task.deadlineText || task.created_at}}</text>
      </view>
    </view>
  </view>

  <!-- 提交状态指示器 -->
  <view class="submit-indicator">
    <!-- 未提交 -->
    <view wx:if="{{task.submission_status === '未提交'}}" class="indicator-dot indicator-empty"></view>
    <!-- 待批改 -->
    <view wx:elif="{{task.submission_status === 'submitted'}}" class="indicator-dot indicator-pending"></view>
    <!-- 已批改 -->
    <view wx:elif="{{task.submission_grade}}" class="indicator-dot indicator-done"></view>
  </view>
</view>