<!-- ä¸Šä¼ è¿›åº¦ç»„ä»¶ -->
<view class="upload-progress-container" wx:if="{{show}}">
  
  <!-- æ•´ä½“ä¸Šä¼ çŠ¶æ€æ  -->
  <view class="overall-progress">
    <view class="progress-header">
      <text class="progress-title">ä¸Šä¼ è¿›åº¦</text>
      <text class="progress-count">{{completedCount}}/{{totalCount}}</text>
    </view>
    
    <!-- æ€»ä½“è¿›åº¦æ¡ -->
    <view class="progress-bar-container">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{overallProgress}}%"></view>
      </view>
      <text class="progress-text">{{overallProgress}}%</text>
    </view>
    
    <!-- ä¸Šä¼ ç»Ÿè®¡ä¿¡æ¯ -->
    <view class="upload-stats">
      <text class="stat-item">é€Ÿåº¦: {{averageSpeed}}KB/s</text>
      <text class="stat-item" wx:if="{{remainingTime > 0}}">å‰©ä½™: {{remainingTimeText}}</text>
    </view>
  </view>

  <!-- å•ä¸ªæ–‡ä»¶ä¸Šä¼ çŠ¶æ€åˆ—è¡¨ -->
  <scroll-view class="upload-list" scroll-y max-height="400rpx">
    <view 
      wx:for="{{uploadItems}}" 
      wx:key="id" 
      class="upload-item {{item.status}}"
    >
      <!-- æ–‡ä»¶ä¿¡æ¯ -->
      <view class="file-info">
        <view class="file-preview">
          <image wx:if="{{item.type === 'image'}}" src="{{item.localPath}}" mode="aspectFill" class="preview-image" />
          <view wx:else class="file-icon">ğŸ“„</view>
        </view>
        
        <view class="file-details">
          <text class="file-name">{{item.name}}</text>
          <text class="file-size">{{item.sizeText}}</text>
        </view>
      </view>
      
      <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
      <view class="status-indicator">
        <!-- ç­‰å¾…çŠ¶æ€ -->
        <view wx:if="{{item.status === 'waiting'}}" class="status-waiting">
          <text class="status-icon">â³</text>
          <text class="status-text">ç­‰å¾…ä¸­</text>
        </view>
        
        <!-- ä¸Šä¼ ä¸­çŠ¶æ€ -->
        <view wx:elif="{{item.status === 'uploading'}}" class="status-uploading">
          <view class="mini-progress-bar">
            <view class="mini-progress-fill" style="width: {{item.progress}}%"></view>
          </view>
          <view class="upload-info">
            <text class="progress-percent">{{item.progress}}%</text>
            <text class="upload-speed" wx:if="{{item.speed > 0}}">{{item.speed}}KB/s</text>
          </view>
        </view>
        
        <!-- æˆåŠŸçŠ¶æ€ -->
        <view wx:elif="{{item.status === 'success'}}" class="status-success">
          <text class="status-icon success">âœ“</text>
          <text class="status-text">å·²å®Œæˆ</text>
          <text class="upload-time">{{item.uploadTimeText}}</text>
        </view>
        
        <!-- å¤±è´¥çŠ¶æ€ -->
        <view wx:elif="{{item.status === 'failed'}}" class="status-failed">
          <text class="status-icon failed">âœ—</text>
          <view class="error-info">
            <text class="status-text">ä¸Šä¼ å¤±è´¥</text>
            <text class="error-message">{{item.errorMessage}}</text>
          </view>
          <button 
            class="retry-btn" 
            size="mini" 
            bindtap="retryUpload" 
            data-id="{{item.id}}"
            wx:if="{{item.retryable}}"
          >
            é‡è¯•
          </button>
        </view>
        
        <!-- å–æ¶ˆæŒ‰é’® -->
        <view 
          wx:if="{{item.status === 'waiting' || item.status === 'uploading'}}"
          class="cancel-btn"
          bindtap="cancelUpload"
          data-id="{{item.id}}"
        >
          <text class="cancel-icon">âœ•</text>
        </view>
      </view>
    </view>
  </scroll-view>
  
  <!-- æ“ä½œæŒ‰é’®åŒº -->
  <view class="action-buttons">
    <button 
      class="btn-secondary" 
      size="mini"
      bindtap="pauseAll"
      wx:if="{{hasUploading}}"
    >
      æš‚åœå…¨éƒ¨
    </button>
    
    <button 
      class="btn-secondary" 
      size="mini"
      bindtap="retryAll"
      wx:if="{{hasFailures}}"
    >
      é‡è¯•å…¨éƒ¨
    </button>
    
    <button 
      class="btn-secondary" 
      size="mini"
      bindtap="clearCompleted"
      wx:if="{{hasCompleted}}"
    >
      æ¸…é™¤å·²å®Œæˆ
    </button>
    
    <button 
      class="btn-primary" 
      size="mini"
      bindtap="close"
    >
      å…³é—­
    </button>
  </view>
</view>

<!-- ç®€åŒ–ç‰ˆè¿›åº¦æŒ‡ç¤ºå™¨ -->
<view class="simple-progress" wx:if="{{showSimple && !show}}">
  <view class="simple-progress-bar">
    <view class="simple-progress-fill" style="width: {{overallProgress}}%"></view>
  </view>
  <text class="simple-progress-text">ä¸Šä¼ ä¸­ {{completedCount}}/{{totalCount}}</text>
</view>