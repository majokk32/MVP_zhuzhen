<!-- GitHub风格14天打卡图组件 V1.0增强版 -->
<view class="checkin-chart">
  <!-- V1.0 新增：智能分析头部 -->
  <view class="analysis-header" wx:if="{{streakInfo.current > 0 || motivationalMsg}}">
    <view class="streak-badge" wx:if="{{streakInfo.current > 0}}">
      <text class="streak-number">{{streakInfo.current}}</text>
      <text class="streak-label">天连续</text>
    </view>
    <view class="motivational-msg" wx:if="{{motivationalMsg}}">
      <text class="msg-text">{{motivationalMsg}}</text>
    </view>
  </view>
  
  <!-- 周标签行 -->
  <view class="week-labels">
    <view class="week-label">周一</view>
    <view class="week-label">周二</view>
    <view class="week-label">周三</view>
    <view class="week-label">周四</view>
    <view class="week-label">周五</view>
    <view class="week-label">周六</view>
    <view class="week-label">周日</view>
  </view>
  
  <!-- 打卡方格图 (2行×7天) -->
  <view class="checkin-grid">
    <!-- 第1行：上周 (Week 2) -->
    <view class="grid-row">
      <view class="grid-item level-{{item.intensity_level || 0}} {{item.checked ? 'checked' : ''}} {{item.is_today ? 'today' : ''}} {{selectedDay === item.date ? 'selected' : ''}}" 
            wx:for="{{weekData[1]}}" 
            wx:key="date"
            data-date="{{item.date}}"
            data-checked="{{item.checked}}"
            data-weekday="{{item.weekday}}"
            bindtap="onDayTap">
        <!-- 新增：今天标记 -->
        <view class="today-indicator" wx:if="{{item.is_today}}"></view>
      </view>
    </view>
    
    <!-- 第2行：本周 (Week 1) -->
    <view class="grid-row">
      <view class="grid-item level-{{item.intensity_level || 0}} {{item.checked ? 'checked' : ''}} {{item.is_today ? 'today' : ''}} {{selectedDay === item.date ? 'selected' : ''}}" 
            wx:for="{{weekData[0]}}" 
            wx:key="date"
            data-date="{{item.date}}"
            data-checked="{{item.checked}}"
            data-weekday="{{item.weekday}}"
            bindtap="onDayTap">
        <!-- 新增：今天标记 -->
        <view class="today-indicator" wx:if="{{item.is_today}}"></view>
      </view>
    </view>
  </view>
  
  
  <!-- 图例说明 -->
  <view class="legend">
    <text class="legend-text">少</text>
    <view class="legend-item level-0"></view>
    <view class="legend-item level-1"></view>
    <view class="legend-item level-2"></view>
    <view class="legend-item level-3"></view>
    <text class="legend-text">多</text>
  </view>
</view>