<!-- 积分排行榜页面 -->
<view class="container">
  <!-- 页面标题和说明 -->
  <view class="header">
    <text class="title">积分排行榜</text>
    <text class="subtitle">激励学习，共同进步 🏆</text>
  </view>

  <!-- 切换标签 -->
  <view class="tab-bar">
    <view class="tab-item {{currentTab === 'monthly' ? 'active' : ''}}" bindtap="switchTab" data-tab="monthly">
      <text>月度榜</text>
    </view>
    <view class="tab-item {{currentTab === 'quarterly' ? 'active' : ''}}" bindtap="switchTab" data-tab="quarterly">
      <text>季度榜</text>
    </view>
  </view>

  <!-- 个人排名卡片 -->
  <view class="my-rank-card" wx:if="{{myRank}}">
    <view class="rank-info">
      <text class="rank-label">我的排名</text>
      <text class="rank-number">{{myRank.rank}}</text>
    </view>
    <view class="score-info">
      <text class="score-number">{{myRank.score}}</text>
      <text class="score-label">积分</text>
    </view>
  </view>

  <!-- 前三名特殊展示 -->
  <view class="top-three" wx:if="{{leaderboardData.length > 0}}">
    <!-- 第二名 -->
    <view class="podium-item second" wx:if="{{leaderboardData[1]}}">
      <image class="avatar" src="{{leaderboardData[1].avatar}}" mode="aspectFill" wx:if="{{leaderboardData[1].avatar}}" />
      <view class="avatar-placeholder" wx:else>👤</view>
      <text class="nickname">{{leaderboardData[1].nickname}}</text>
      <text class="score">{{leaderboardData[1].score}}</text>
      <view class="medal silver">🥈</view>
    </view>

    <!-- 第一名 -->
    <view class="podium-item first" wx:if="{{leaderboardData[0]}}">
      <image class="avatar large" src="{{leaderboardData[0].avatar}}" mode="aspectFill" wx:if="{{leaderboardData[0].avatar}}" />
      <view class="avatar-placeholder large" wx:else>👤</view>
      <text class="nickname">{{leaderboardData[0].nickname}}</text>
      <text class="score">{{leaderboardData[0].score}}</text>
      <view class="medal gold">🥇</view>
      <view class="crown">👑</view>
    </view>

    <!-- 第三名 -->
    <view class="podium-item third" wx:if="{{leaderboardData[2]}}">
      <image class="avatar" src="{{leaderboardData[2].avatar}}" mode="aspectFill" wx:if="{{leaderboardData[2].avatar}}" />
      <view class="avatar-placeholder" wx:else>👤</view>
      <text class="nickname">{{leaderboardData[2].nickname}}</text>
      <text class="score">{{leaderboardData[2].score}}</text>
      <view class="medal bronze">🥉</view>
    </view>
  </view>

  <!-- 排行榜列表 -->
  <view class="leaderboard-list">
    <view class="list-header">
      <text>排名</text>
      <text>用户</text>
      <text>积分</text>
    </view>
    
    <view class="list-item {{item.is_current_user ? 'current-user' : ''}}" 
          wx:for="{{leaderboardData}}" 
          wx:key="user_id"
          wx:if="{{index >= 3}}">
      <view class="rank">
        <text class="rank-number">{{item.rank}}</text>
      </view>
      <view class="user-info">
        <image class="small-avatar" src="{{item.avatar}}" mode="aspectFill" wx:if="{{item.avatar}}" />
        <view class="small-avatar-placeholder" wx:else>👤</view>
        <text class="user-nickname">{{item.nickname}}</text>
      </view>
      <view class="score">
        <text class="score-number">{{item.score}}</text>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{leaderboardData.length === 0 && !loading}}">
    <text class="empty-icon">📊</text>
    <text class="empty-text">暂无排行榜数据</text>
    <text class="empty-desc">完成作业和打卡来获得积分吧！</text>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>加载中...</text>
  </view>

  <!-- 排行榜说明 -->
  <view class="info-section">
    <text class="info-title">积分规则</text>
    <view class="info-item">
      <text class="rule-text">• 作业提交：+1分</text>
    </view>
    <view class="info-item">
      <text class="rule-text">• 获得"优秀"：+2分</text>
    </view>
    <view class="info-item">
      <text class="rule-text">• 获得"极佳"：+5分</text>
    </view>
    <view class="info-item">
      <text class="rule-text">• 连续打卡奖励：+1~10分</text>
    </view>
    <view class="info-item">
      <text class="rule-text">• 完成复盘：+1分</text>
    </view>
  </view>
</view>

<!-- 底部安全区域 -->
<view class="safe-bottom"></view>