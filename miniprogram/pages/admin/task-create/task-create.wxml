<!-- 创建新任务页 -->
<view class="container">
  <!-- 标题 -->
  <view class="page-header">
    <text class="page-title">新建申论任务</text>
  </view>

  <!-- 表单内容 -->
  <form bindsubmit="onSubmit" class="form-container">
    <!-- 课程名称 -->
    <view class="form-group">
      <view class="form-label">课程名称</view>
      <input 
        class="form-input {{errors.title ? 'error' : ''}}"
        name="title"
        placeholder="请输入课程或任务的名称"
        value="{{formData.title}}"
        bindinput="onInputChange"
        data-field="title"
        maxlength="50"
      />
      <view wx:if="{{errors.title}}" class="error-text">{{errors.title}}</view>
    </view>

    <!-- 直播开始时间 -->
    <view class="form-group">
      <view class="form-label">直播开始时间</view>
      <view class="datetime-row">
        <picker 
          mode="date" 
          value="{{formData.startDate}}" 
          bindchange="onStartDateChange"
          class="form-input datetime-picker {{errors.startDate ? 'error' : ''}}"
        >
          <text class="{{formData.startDate ? '' : 'placeholder'}}">
            {{formData.startDate || '选择日期'}}
          </text>
        </picker>
        <picker 
          mode="time" 
          value="{{formData.startTime}}" 
          bindchange="onStartTimeChange"
          class="form-input datetime-picker {{errors.startTime ? 'error' : ''}}"
        >
          <text class="{{formData.startTime ? '' : 'placeholder'}}">
            {{formData.startTime || '选择时间'}}
          </text>
        </picker>
      </view>
      <view wx:if="{{errors.startDate || errors.startTime}}" class="error-text">
        {{errors.startDate || errors.startTime}}
      </view>
    </view>


    <!-- 题目详情 -->
    <view class="form-group">
      <view class="form-label">题目详情</view>
      <textarea 
        class="form-textarea {{errors.desc ? 'error' : ''}}"
        placeholder="请在此处输入详细的题目要求和背景材料..."
        value="{{formData.desc}}"
        bindinput="onInputChange"
        data-field="desc"
        maxlength="2000"
        show-confirm-bar="{{false}}"
        auto-height
      />
      <view wx:if="{{errors.desc}}" class="error-text">{{errors.desc}}</view>
      <view class="input-counter">{{formData.desc.length}}/2000</view>
    </view>

    <!-- 底部设置行 -->
    <view class="form-row">
      <!-- 截止日期 -->
      <view class="form-group half">
        <view class="form-label">截止日期</view>
        <picker 
          mode="date" 
          value="{{formData.deadlineDate}}" 
          bindchange="onDeadlineDateChange"
          class="form-input {{errors.deadlineDate ? 'error' : ''}}"
        >
          <text class="{{formData.deadlineDate ? '' : 'placeholder'}}">
            {{formData.deadlineDate || '请选择截止日期'}}
          </text>
        </picker>
        <view wx:if="{{errors.deadlineDate}}" class="error-text">{{errors.deadlineDate}}</view>
      </view>

      <!-- 任务类型 -->
      <view class="form-group half">
        <view class="form-label">任务类型</view>
        <picker 
          range="{{taskTypes}}" 
          range-key="name"
          value="{{formData.typeIndex}}" 
          bindchange="onTypeChange"
          class="form-input"
        >
          <text>{{taskTypes[formData.typeIndex].name}}</text>
        </picker>
      </view>
    </view>

    <!-- 创建任务按钮 -->
    <button 
      class="submit-btn" 
      form-type="submit"
      disabled="{{!canSubmit || isSubmitting}}"
    >
      {{isSubmitting ? '创建中...' : '创建任务'}}
    </button>
  </form>
</view>

<!-- 底部安全区域 -->
<view class="safe-bottom"></view>