<!--学习复盘主页面 - 简化版本-->
<view class="container">
  <!-- 复盘任务标题 -->
  <view class="page-header">
    <text class="page-title">复盘任务</text>
    <text class="task-count">{{todayReviewTasks.length}}个任务待完成</text>
  </view>
  
  <!-- 今日任务列表 -->
  <view class="tasks-list">
    <view 
      class="task-card {{item.status === 'overdue' ? 'overdue' : ''}}"
      wx:for="{{todayReviewTasks}}"
      wx:key="id"
    >
      <view 
        class="task-info"
        bindtap="viewTaskDetail"
        data-id="{{item.id}}"
      >
        <text class="task-title">{{item.title}}</text>
        <view class="task-meta">
          <text class="task-subject">{{item.subject}}</text>
          <text class="task-count">第{{item.review_count + 1}}次复盘</text>
          <text class="task-date">{{item.ebbinghaus_day}}天复盘</text>
          <text class="task-original">原学习：{{item.original_date}}</text>
          <text class="task-status {{item.status}}" wx:if="{{item.status === 'overdue'}}">
            已过期{{item.days_overdue}}天
          </text>
        </view>
      </view>
      
      <view class="task-actions">
        <button 
          class="task-btn complete {{item.status === 'completed' ? 'disabled' : ''}}" 
          bindtap="startReview"
          data-id="{{item.id}}"
          disabled="{{item.status === 'completed'}}"
        >
          {{item.status === 'completed' ? '已完成' : '完成'}}
        </button>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-tasks" wx:if="{{todayReviewTasks.length === 0 && !loading}}">
      <text class="empty-icon">🎉</text>
      <text class="empty-text">今日无复盘任务</text>
      <text class="empty-desc">休息一下，明天再来！</text>
    </view>
  </view>

  <!-- TODO: 复杂功能暂时隐藏 - 预留为未来版本 -->
  <!-- 复盘设置 -->
  <!-- <view class="settings-section">
    <view class="section-title">
      <text>复盘设置</text>
      <text class="edit-btn" bindtap="editSettings">编辑</text>
    </view>
    
    <view class="settings-list">
      <view class="setting-item">
        <text class="setting-label">复盘频率</text>
        <text class="setting-value">{{frequencyMap[reviewSettings.frequency] || '每周'}}</text>
      </view>
      
      <view class="setting-item" wx:if="{{reviewSettings.frequency === 'custom'}}">
        <text class="setting-label">自定义周期</text>
        <text class="setting-value">{{reviewSettings.custom_days}}天</text>
      </view>
      
      <view class="setting-item">
        <text class="setting-label">偏好时间</text>
        <text class="setting-value">{{reviewSettings.preferred_time}}:00</text>
      </view>
      
      <view class="setting-item">
        <text class="setting-label">提醒通知</text>
        <switch 
          checked="{{reviewSettings.reminder_enabled}}"
          bindchange="toggleReminder"
          color="#4CAF50"
        />
      </view>
    </view>
  </view> -->

  <!-- 复盘统计 -->
  <!-- <view class="stats-section">
    <view class="section-title">
      <text>复盘统计</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{reviewStats.total_reviews || 0}}</text>
        <text class="stat-label">总复盘次数</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-number">{{reviewStats.completion_rate || 0}}%</text>
        <text class="stat-label">完成率</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-number">{{reviewStats.avg_completion_duration || 0}}</text>
        <text class="stat-label">平均时长(分钟)</text>
      </view>
      
      
      <view class="stat-item">
        <text class="stat-number">{{reviewStats.pending_count || 0}}</text>
        <text class="stat-label">待完成</text>
      </view>
    </view>
  </view> -->

  <!-- 历史记录 -->
  <!-- <view class="history-section">
    <view class="section-title">
      <text>最近复盘</text>
      <text class="more-btn" bindtap="showAllHistory">查看全部</text>
    </view>
    
    <view class="history-list">
      <view 
        class="history-item" 
        wx:for="{{reviewHistory}}" 
        wx:key="id"
        bindtap="viewReviewDetail"
        data-id="{{item.id}}"
      >
        <view class="history-date">
          <text class="date-text">{{item.review_date}}</text>
          <text class="period-text">{{item.period_start}} - {{item.period_end}}</text>
        </view>
        
        <view class="history-status">
          <text class="status-badge {{item.status}}">
            {{statusMap[item.status] || '未知'}}
          </text>
        </view>
        
        <view class="history-arrow">
          <text class="arrow-icon">></text>
        </view>
      </view>
      
      <view class="empty-history" wx:if="{{reviewHistory.length === 0}}">
        <text>暂无复盘记录</text>
      </view>
    </view>
  </view> -->
</view>

<!-- TODO: 复杂设置弹窗暂时隐藏 - 预留为未来版本 -->
<!-- 复盘设置弹窗 -->
<!-- <view class="settings-modal" wx:if="{{showSettingsModal}}" bindtap="closeSettingsModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">复盘设置</text>
      <text class="modal-close" bindtap="closeSettingsModal">×</text>
    </view>
    
    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">复盘频率</text>
        <picker 
          mode="selector" 
          range="{{frequencyOptions}}" 
          range-key="label"
          value="{{frequencyIndex}}"
          bindchange="onFrequencyChange"
        >
          <view class="picker-view">
            {{frequencyOptions[frequencyIndex].label}}
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
      
      <view class="form-group" wx:if="{{tempSettings.frequency === 'custom'}}">
        <text class="form-label">自定义天数</text>
        <input 
          class="form-input"
          type="number"
          placeholder="请输入天数"
          value="{{tempSettings.custom_days}}"
          bindinput="onCustomDaysInput"
        />
      </view>
      
      <view class="form-group">
        <text class="form-label">偏好时间</text>
        <picker 
          mode="time" 
          value="{{tempSettings.preferred_time}}"
          bindchange="onTimeChange"
        >
          <view class="picker-view">
            {{tempSettings.preferred_time}}:00
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
      
      <view class="form-group">
        <text class="form-label">复盘内容</text>
        <view class="checkbox-group">
          <label class="checkbox-item">
            <checkbox 
              checked="{{tempSettings.include_scores}}"
              bindchange="onContentChange"
              data-field="include_scores"
            />
            <text>成绩统计</text>
          </label>
          
          <label class="checkbox-item">
            <checkbox 
              checked="{{tempSettings.include_mistakes}}"
              bindchange="onContentChange"
              data-field="include_mistakes"
            />
            <text>错题回顾</text>
          </label>
          
          <label class="checkbox-item">
            <checkbox 
              checked="{{tempSettings.include_progress}}"
              bindchange="onContentChange"
              data-field="include_progress"
            />
            <text>学习进度</text>
          </label>
          
          <label class="checkbox-item">
            <checkbox 
              checked="{{tempSettings.include_suggestions}}"
              bindchange="onContentChange"
              data-field="include_suggestions"
            />
            <text>学习建议</text>
          </label>
        </view>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="modal-btn secondary" bindtap="closeSettingsModal">
        取消
      </button>
      <button class="modal-btn primary" bindtap="saveSettings">
        保存
      </button>
    </view>
  </view>
</view> -->