# 公考督学助手 - AI高效协作开发规范

## 🎯 核心目标
**15-30分钟首版交付，1小时内完成迭代，零Bug上线**

## 📋 开发工作流

### Phase 1: 任务接收 (2-3分钟)
```
输入格式：
【功能】：具体功能描述
【优先级】：P0/P1/P2
【验收标准】：明确的完成定义
【依赖】：前置条件或依赖模块

输出确认：
- ✅ 需求理解确认
- ✅ 技术方案概述  
- ✅ 预估时间
- ❓ 澄清问题（如有）
```

### Phase 2: 设计实现 (15-25分钟)
```
执行顺序：
1. 数据模型设计（2分钟）
2. 接口设计（3分钟）  
3. 核心逻辑实现（15分钟）
4. 错误处理（3分钟）
5. 基础测试（2分钟）

质量检查：
- 代码规范自检
- 边界情况处理
- 用户体验考量
- 性能基本优化
```

### Phase 3: 交付验证 (3-5分钟)
```
交付物：
- ✅ 可运行代码
- ✅ 关键功能演示
- ✅ 潜在问题说明
- ✅ 后续优化建议

验证清单：
- 核心功能正常
- 异常情况优雅处理
- 代码可读性良好
- 符合PRD要求
```

## 🏗️ 架构设计原则

### 模块化设计
```
后端模块：
├── models/          # 数据模型（单一职责）
├── api/            # 接口层（薄薄一层）
├── services/       # 业务逻辑（核心实现）
├── utils/          # 工具函数（纯函数）
└── tests/          # 测试用例（覆盖主路径）

前端模块：
├── pages/          # 页面组件（视图层）
├── components/     # 通用组件（可复用）
├── modules/        # 业务模块（逻辑封装）
├── utils/          # 工具函数（纯函数）
└── assets/         # 静态资源
```

### 接口约定
```javascript
// 统一响应格式
{
  "code": 0,        // 0=成功，其他=错误码
  "msg": "ok",      // 人类可读消息
  "data": {}        // 实际数据
}

// 统一错误处理
try {
  // 业务逻辑
} catch (error) {
  return ErrorResponse(error.code, error.message)
}
```

## 🔧 代码质量标准

### 必须遵守的规范
1. **单一职责**：每个函数只做一件事
2. **清晰命名**：见名知意，避免缩写
3. **错误处理**：所有异常都有优雅降级
4. **注释完备**：复杂逻辑必须有注释
5. **类型安全**：关键参数做类型检查

### 代码示例模板
```javascript
/**
 * 提交作业
 * @param {string} taskId - 任务ID
 * @param {Array} images - 图片数组
 * @param {string} description - 作业描述
 * @returns {Promise<Object>} 提交结果
 */
async function submitAssignment(taskId, images, description) {
  // 1. 参数验证
  if (!taskId || !images?.length) {
    throw new ValidationError('参数不完整')
  }
  
  // 2. 业务逻辑
  const submission = await submissionService.create({
    task_id: taskId,
    images: images,
    description: description
  })
  
  // 3. 返回结果
  return {
    code: 0,
    msg: '提交成功',
    data: submission
  }
}
```

## 🚀 快速开发模式

### AI开发时的思维框架
1. **理解需求** → 明确输入输出，确定边界
2. **设计接口** → 定义数据结构，约定调用方式
3. **实现核心** → 最小可用版本，专注主流程
4. **处理异常** → 预测失败情况，优雅降级
5. **验证功能** → 构造测试用例，确保正确性

### 快速决策原则
- **优先可用性** > 完美优化
- **用户体验** > 技术炫技
- **简单直接** > 过度设计
- **文档清晰** > 代码巧妙

## 📚 文档驱动开发

### 必要文档结构
```
docs/
├── api/                 # API接口文档
│   ├── users.md        # 用户相关接口
│   ├── tasks.md        # 任务相关接口
│   └── submissions.md  # 提交相关接口
├── components/         # 组件使用文档
├── deployment/         # 部署运维文档
├── issues/            # 问题记录文档
└── decisions/         # 技术决策记录
```

### 实时文档更新
- **新功能** → 同步更新API文档
- **Bug修复** → 记录到issues/文档
- **架构变更** → 更新decisions/文档
- **部署变更** → 更新deployment/文档

## ⚡ AI协作提示词

### 开发任务格式
```
【任务】：[功能名称]
【类型】：[新功能/Bug修复/优化重构]
【文件】：[涉及的文件路径]
【需求】：[具体要实现什么]
【验收】：[如何判断完成]
【注意】：[特殊考虑事项]
```

### AI开发承诺
我将确保：
- ✅ **15-30分钟交付**首版可用代码
- ✅ **一次性正确**，避免反复修改
- ✅ **完整错误处理**，优雅降级
- ✅ **清晰代码结构**，人类可读
- ✅ **同步文档更新**，知识沉淀
- ❓ **主动澄清疑点**，避免理解偏差

### 质量保证机制
1. **开发前**：需求澄清，技术方案确认
2. **开发中**：遵循规范，实时自检
3. **开发后**：功能验证，文档更新
4. **交付时**：演示说明，问题预警

## 🎯 成功标准

### 时间目标
- **简单功能**：15分钟内完成
- **中等功能**：25分钟内完成  
- **复杂功能**：30分钟内完成首版

### 质量目标
- **功能正确性**：100%符合需求
- **代码可读性**：人类和AI都易懂
- **错误处理**：边界情况全覆盖
- **用户体验**：操作流畅，提示友好

## 🛠️ 项目特定配置

### 技术栈
- **后端**：FastAPI + SQLAlchemy + SQLite(开发)/PostgreSQL(生产)
- **前端**：微信小程序原生框架 + 模块化设计
- **存储**：本地文件(开发) → 阿里云OSS(生产)
- **认证**：JWT + 微信授权

### 关键命令
```bash
# 后端启动
cd backend
uvicorn app.main:app --reload

# 前端开发
# 微信开发者工具导入 miniprogram/ 目录

# 代码规范检查
npm run lint  # 如果配置了的话

# 数据库检查
python backend/check_db.py
```

### 常见问题解决
1. **数据库连接失败** → 检查 backend/.env 配置
2. **微信授权失败** → 检查 AppID 和 AppSecret
3. **图片上传失败** → 检查 uploads/ 目录权限
4. **小程序白屏** → 检查后端服务是否启动

### 开发环境设置
```bash
# 确保在项目根目录
cd /d/projects-2025/MVP_zhuzhen

# 后端依赖安装
cd backend && pip install -r requirements.txt

# 环境变量配置（首次运行需要创建 .env）
cp .env.example .env  # 如果有示例文件
```

**核心理念**：快速、正确、优雅，让开发者专注产品而非代码细节

---

> 最后更新：2025-09-06
> 版本：v1.0
> 维护者：AI Assistant + 产品团队